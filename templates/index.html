<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GoonerBrain Meta Search</title>
  <meta name="description" content="Search across top adult sites instantly. GoonerBrain is the ultimate NSFW video search tool." />
  <meta property="og:title" content="GoonerBrain Meta Search">
  <meta property="og:description" content="Search across top adult sites instantly. GoonerBrain is the ultimate NSFW video search tool.">
  <meta property="og:image" content="https://goonerbrain.com/og-image.jpg">
  <meta property="og:url" content="https://goonerbrain.com">
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="GoonerBrain Meta Search">
  <meta name="twitter:description" content="Search across top adult sites instantly.">
  <meta name="twitter:image" content="https://goonerbrain.com/og-image.jpg">
  <link rel="icon" href="/favicon.ico" />
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-black text-white min-h-screen px-4 py-8">
  <h1 class="text-center text-4xl sm:text-5xl font-bold text-pink-400 mb-8 animate-pulse">
    GoonerBrain Meta Search
  </h1>
  <form onsubmit="event.preventDefault(); doSearch();" class="max-w-xl mx-auto mb-8">
    <input id="search" type="text" placeholder="Search..." autocomplete="off"
           class="w-full p-4 rounded-xl text-lg bg-zinc-900 border-2 border-pink-400 text-white focus:ring-2 focus:ring-pink-500 shadow-[0_0_10px_hotpink]" />
  </form>
  <div id="results"></div>

  <script>
    const backend = location.hostname.includes("goonerbrain") 
      ? "https://goonerbrain.com" 
      : "http://localhost:8000";

    async function doSearch() {
      const q = document.getElementById("search").value.trim();
      const out = document.getElementById("results");
      if (!q) return;
      out.innerHTML = `<p class='text-center text-pink-300 animate-pulse'>Searching for <b>${q}</b>...</p>`;

      try {
        const res = await fetch(`${backend}/search?query=${encodeURIComponent(q)}`);
        const data = await res.json();

        const results = data.results || [];
        if (!results.length) {
          out.innerHTML = `<p class='text-center text-gray-400'>No results found.</p>`;
          return;
        }

        out.innerHTML = `<div class="grid gap-6 grid-cols-1 sm:grid-cols-2 md:grid-cols-3">` +
          results.map(v => {
            const preview = v.preview?.trim() || `https://via.placeholder.com/300x160?text=${encodeURIComponent(v.source + " " + q)}`;
            const isVideo = /\.(mp4|webm)$/i.test(preview);
            return `
              <div class="bg-zinc-800 p-4 rounded-xl shadow-[0_0_10px_hotpink] hover:shadow-[0_0_20px_deeppink] transition-transform duration-300 hover:scale-105">
                <a href="${v.url}" target="_blank" rel="noopener noreferrer">
                  ${isVideo
                    ? `<video src="${preview}" muted loop preload="none" class="rounded mb-2 w-full h-48 object-cover" 
                        onmouseover="this.play()" onmouseout="this.pause(); this.currentTime = 0;"></video>`
                    : `<img src="${preview}" alt="${v.title}" class="rounded mb-2 w-full h-48 object-cover" />`
                  }
                  <h3 class="text-lg font-semibold text-pink-300">${v.title}</h3>
                  <p class="text-sm text-zinc-400">üì∫ ${v.source}</p>
                </a>
              </div>`;
          }).join('') + `</div>`;
      } catch (e) {
        console.error("‚ùå Fetch error:", e);
        out.innerHTML = `<p class='text-red-500 text-center'>Error: ${e.message}</p>`;
      }
    }
  </script>
</body>
</html>
